All the code will be provided after revision.
